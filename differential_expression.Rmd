---
title: "Differential Expression Analysis"
output: html_document
date: "2025-12-09"
---

#Differential Expression Analysis

```{r}
# Imported the files from HPC to local

library(data.table)
library(DESeq2)

setwd("C:/Users/sarah/OneDrive/Desktop/KCL/APCC/Group")

data <- fread("C:/Users/sarah/Downloads/gene_counts.txt", header = TRUE)

# Create a numeric matrix with the load counts
counts <- as.matrix(data[, 7:12, with=FALSE])
rownames(counts) <- data$Geneid

grown_condition <- factor(c("glucose", "glucose","glucose", "cellobiose", "cellobiose", "cellobiose"))
col_data<- data.frame(row.names = colnames(counts), grown_condition)

#Create the DESeqDataSet object
data <- DESeqDataSetFromMatrix(
    countData = counts, 
    colData = col_data,
    design = ~ grown_condition 
)

# DESeq 
data <- DESeq(data)
results_deseq <- results(data)
write.csv(results_deseq, file = "DESEQ_results.csv", row.names = FALSE)


# Normalised counts
norm_counts <- counts(data, normalized = TRUE)
# Create a csv 
write.csv(norm_counts, file = "normalised_counts.csv", row.names = TRUE)

```


